# Task Management System - Backend Services

### Backend система управления задачами, реализованная на FastAPI с микросервисной архитектурой. Состоит из двух основных сервисов: аутентификации и управления задачами.


### Микросервисная архитектура
```
┌─────────────────┐    ┌──────────────────┐
│   Auth Service  │    │   Task Service   │
│                 │    │                  │
│ • Регистрация   │◄──►│ • Создание задач │
│ • Аутентификация│    │ • Управление     │
│ • JWT токены    │    │ • Фильтрация     │
└─────────────────┘    └──────────────────┘
         │                      │
         └─────── RabbitMQ ─────┘
```

### Миграции базы данных
```bash
# Для auth_service
cd auth_service
alembic upgrade head

# Для task_service  
cd task_service
alembic upgrade head
```

## Task Service

##### Архитектура
Task Service также построен по многослойной архитектуре (Layered Architecture) для обеспечения масштабируемости и поддерживаемости кода.
Слои архитектуры:

    Presentation Layer (routers/tasks.py) - обработка HTTP запросов и ответов

    Services Layer (services/task_service.py) - бизнес-логика управления задачами

    Data Access Layer (repositories/task_repo.py) - работа с данными, запросы к БД

    Data Layer (models/task.py) - модели данных и миграции

##### Процесс работы с задачами
Создание задачи:

Пользователь создает новую задачу через API. Система выполняет:

    routers/tasks.py (валидация запроса и формирование ответа)

    services/task_service.py (применение бизнес-правил)

    repositories/task_repo.py (сохранение в базу данных)

    Валидация токена - через RabbitMQ запрос к Auth Service

    Проверка прав доступа - пользователь может создавать задачи только для себя

    Валидация данных - проверка обязательных полей и форматов

    Создание записи - сохранение задачи в базу данных

##### Получение списка задач:

    GET /tasks - возвращает задачи текущего пользователя

    Поддержка фильтрации по статусу, приоритету, датам

    Пагинация результатов

##### Механизм аутентификации и авторизации
Верификация токенов:

Каждый запрос к Task Service проходит проверку:

    Извлечение токена из заголовка Authorization

    Валидация через RabbitMQ - асинхронный запрос к Auth Service

    Проверка прав доступа - пользователь имеет доступ только к своим задачам

Безопасность данных:

    Все операции привязаны к user_id из JWT токена

    Запрещены кросс-пользовательские операции

    Валидация входных данных через Pydantic схемы



## **Auth service**

### **Архитектура**
Так как приложение не большое но имеет возможность для масшатабирования для
backend я выберу Layered(многослойную) архитектуру
Краткое описание:
Presentation layer(Обработка http запросов и ответов)
Services layer(Бизнес логика)
Data access layer(Уровень доступа к данным, тут находят конкретные запросы к
данным)
Data layer(Тут лежат сами данные)


#### Процесс регистрации нового пользователя:
```
  Пользователь заполняет форму регистрации, указывая email и пароль.
  Система выполняет следующие шаги:
    routers/users.py (обработка http-запросов и ответов)
    services/users.py (логика и ее правила)
    repo/users.py (непосредственно работа с данными)
    1. Проверяет уникальность email в базе данных
    2. Хеширует пароль с использованием алгоритма bcrypt
    3. Создает новую запись пользователя в базе данных
```

#### Процесс аутентификации
При входе в систему:
  ```
  1. Пользователь вводит email и пароль
  2. Сервер находит пользователя по email и проверяет хеш пароля
  3. При успешной проверке генерируется пара JWT-токенов:
  Access Token - короткоживущий (7-15 минут), содержит payload с user_id,
  email и ролью
  Refresh Token - долгоживущий (7 дней), сохраняется в безопасном хранилище
  4. Токены возвращаются клиенту для последующих запросов
```

#### Механизм защиты API
Каждый запрос к защищенным endpoint'ам требует Access Token в заголовке
Authorization.

посмотреть и потыкать [тут](https://auth-service-v2-rqoi.onrender.com/)
деплоил через render.com
так же ссылка на описание(notion) первого проекта [тут](https://www.notion.so/task-tracker-28cc206df76c80d49675c4dcac4f084e?source=copy_link)
